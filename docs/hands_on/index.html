<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.81.0" /><META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">


<link rel="shortcut icon" href="/new-site/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/new-site/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/new-site/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/new-site/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/new-site/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/new-site/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/new-site/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/new-site/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/new-site/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/new-site/favicons/android-192x192.png" sizes="192x192">

<title>Hands-on tutorial | PDI</title><meta property="og:title" content="Hands-on tutorial" />
<meta property="og:description" content="In this tutorial, you will build a PDI-enabled application step-by-step from a PDI-free base. You will end-up building the C version of the example provided with PDI for the the Trace, Decl&#39;HDF5, and Pycall plugins. Additional examples are available for the other plugins.
Setup PDI Installation To run this hands-on tutorial, you will of course first need to install PDI and setup your environment.
On Juwels, PDI is pre-installed as part of the training2022 environment." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://pdi.julien-bigot.fr/new-site/docs/hands_on/" /><meta property="article:section" content="docs" />



<meta itemprop="name" content="Hands-on tutorial">
<meta itemprop="description" content="In this tutorial, you will build a PDI-enabled application step-by-step from a PDI-free base. You will end-up building the C version of the example provided with PDI for the the Trace, Decl&#39;HDF5, and Pycall plugins. Additional examples are available for the other plugins.
Setup PDI Installation To run this hands-on tutorial, you will of course first need to install PDI and setup your environment.
On Juwels, PDI is pre-installed as part of the training2022 environment.">

<meta itemprop="wordCount" content="2304">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Hands-on tutorial"/>
<meta name="twitter:description" content="In this tutorial, you will build a PDI-enabled application step-by-step from a PDI-free base. You will end-up building the C version of the example provided with PDI for the the Trace, Decl&#39;HDF5, and Pycall plugins. Additional examples are available for the other plugins.
Setup PDI Installation To run this hands-on tutorial, you will of course first need to install PDI and setup your environment.
On Juwels, PDI is pre-installed as part of the training2022 environment."/>







<link rel="preload" href="/new-site/scss/main.min.f58ec8ad74eb1037062242b8bf990817929ecc905cc370df61c237aad2861338.css" as="style">
<link href="/new-site/scss/main.min.f58ec8ad74eb1037062242b8bf990817929ecc905cc370df61c237aad2861338.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script
  src="https://unpkg.com/lunr@2.3.9/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>



<link rel="stylesheet" href="/new-site/css/tabbed-pane.css"/>




  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/new-site/">
		<span class="navbar-logo"><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="svg8" viewBox="0 0 40 40"><defs id="defs2"><linearGradient id="linearGradient846"><stop id="stop842" offset="0" style="stop-color:#3a82c2;stop-opacity:1"/><stop style="stop-color:#073763;stop-opacity:1" offset=".4946366" id="stop850"/><stop id="stop844" offset="1" style="stop-color:#3a82c2;stop-opacity:1"/></linearGradient><linearGradient gradientTransform="matrix(1.1064998,0,0,1.1064998,-2.8109111,-3.2500611)" gradientUnits="userSpaceOnUse" y2="6.0482411" x2="25.209953" y1="41.294521" x1="25.249392" id="linearGradient848" xlink:href="#linearGradient846"/><filter id="filter1270" style="color-interpolation-filters:sRGB"><feFlood id="feFlood1260" result="flood" flood-color="rgb(0,0,0)" flood-opacity=".498039"/><feComposite id="feComposite1262" result="composite1" operator="in" in2="SourceGraphic" in="flood"/><feGaussianBlur id="feGaussianBlur1264" result="blur" stdDeviation="1" in="composite1"/><feOffset id="feOffset1266" result="offset" dy=".6" dx=".6"/><feComposite id="feComposite1268" result="composite2" operator="over" in2="offset" in="SourceGraphic"/></filter></defs><g transform="translate(-4.6772165,-3.1371543)" id="layer1"><circle r="19.5" cy="22.994598" cx="24.687487" id="path840" style="opacity:1;fill:url(#linearGradient848);fill-opacity:1;stroke:none;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"/><flowRoot transform="matrix(0.26458333,0,0,0.26458333,4.6772165,3.1371543)" style="font-style:normal;font-weight:400;font-size:40px;line-height:1.25;font-family:sans-serif;letter-spacing:0;word-spacing:0;fill:#000;fill-opacity:1;stroke:none" id="flowRoot852"><flowRegion id="flowRegion854"><rect y="55.823959" x="32.857143" height="43.92857" width="94.285713" id="rect856"/></flowRegion><flowPara id="flowPara858">PPd</flowPara></flowRoot><text transform="matrix(1.0723861,0,0,1.0723861,-1.9406576,-2.4256035)" id="text862" y="30.191469" x="10.006681" style="font-style:normal;font-weight:400;font-size:10.58333302px;line-height:1.25;font-family:sans-serif;letter-spacing:0;word-spacing:0;fill:#fff;fill-opacity:1;stroke:none;stroke-width:.24672395;filter:url(#filter1270)"><tspan style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:17.63888931px;font-family:sans-serif;-inkscape-font-specification:sans-serif;fill:#fff;fill-opacity:1;stroke-width:.24672395" y="30.191469" x="10.006681" id="tspan860">PDI</tspan></text></g></svg></span><span class="text-uppercase font-weight-bold">PDI</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link active" href="/new-site/docs/" ><span class="active">Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/new-site/community/" ><span>Community</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">
<input type="search" class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete="off">

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            




  


<div id="td-sidebar-menu" class="td-sidebar__inner">
  
  <form class="td-sidebar__search d-flex align-items-center">
    
<input type="search" class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete="off">


    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  
  <nav class="collapse td-sidebar-nav" id="td-section-nav">
    
    
    
    
    
    <ul class="td-sidebar-nav__section pr-md-3 ul-0">
      
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-new-sitedocs-li">
    <a href="/new-site/docs/" title="About" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section tree-root" id="m-new-sitedocs"><span class="">Documentation</span></a>
    
      
      <ul class="pr-md-3 ul-1">
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-new-sitedocsref-li">
    <a href="/new-site/docs/ref/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsref"><span class="">C&#43;&#43; API reference</span></a>
    
      
      <ul class="pr-md-3 ul-2">
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id="m-new-sitedocsrefpdi-li">
    <a href="/new-site/docs/ref/pdi/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdi"><span class="">PDI</span></a>
    
      
      <ul class="pr-md-3 ul-3">
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id="m-new-sitedocsrefpdiarray_datatype-li">
    <a href="/new-site/docs/ref/pdi/array_datatype/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdiarray_datatype"><span class="">Array_datatype</span></a>
    
      
      <ul class="pr-md-3 ul-4">
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdiarray_datatypeindex_accessor-li">
    <a href="/new-site/docs/ref/pdi/array_datatype/index_accessor/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdiarray_datatypeindex_accessor"><span class="">Index_accessor</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdiarray_datatypeslice_accessor-li">
    <a href="/new-site/docs/ref/pdi/array_datatype/slice_accessor/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdiarray_datatypeslice_accessor"><span class="">Slice_accessor</span></a>
    
  </li>

          
        
      </ul>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdicallbacks-li">
    <a href="/new-site/docs/ref/pdi/callbacks/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdicallbacks"><span class="">Callbacks</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdiconfig_error-li">
    <a href="/new-site/docs/ref/pdi/config_error/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdiconfig_error"><span class="">Config_error</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id="m-new-sitedocsrefpdicontext-li">
    <a href="/new-site/docs/ref/pdi/context/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdicontext"><span class="">Context</span></a>
    
      
      <ul class="pr-md-3 ul-4">
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdicontextiterator-li">
    <a href="/new-site/docs/ref/pdi/context/iterator/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdicontextiterator"><span class="">Iterator</span></a>
    
  </li>

          
        
      </ul>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdicontext_proxy-li">
    <a href="/new-site/docs/ref/pdi/context_proxy/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdicontext_proxy"><span class="">Context_proxy</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdidata_descriptor-li">
    <a href="/new-site/docs/ref/pdi/data_descriptor/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdidata_descriptor"><span class="">Data_descriptor</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id="m-new-sitedocsrefpdidatatype-li">
    <a href="/new-site/docs/ref/pdi/datatype/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdidatatype"><span class="">Datatype</span></a>
    
      
      <ul class="pr-md-3 ul-4">
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdidatatypeaccessor_base-li">
    <a href="/new-site/docs/ref/pdi/datatype/accessor_base/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdidatatypeaccessor_base"><span class="">Accessor_base</span></a>
    
  </li>

          
        
      </ul>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdidatatype_template-li">
    <a href="/new-site/docs/ref/pdi/datatype_template/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdidatatype_template"><span class="">Datatype_template</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdierror-li">
    <a href="/new-site/docs/ref/pdi/error/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdierror"><span class="">Error</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdiexpression-li">
    <a href="/new-site/docs/ref/pdi/expression/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdiexpression"><span class="">Expression</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdiimpl_error-li">
    <a href="/new-site/docs/ref/pdi/impl_error/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdiimpl_error"><span class="">Impl_error</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdiparaconf_wrapper-li">
    <a href="/new-site/docs/ref/pdi/paraconf_wrapper/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdiparaconf_wrapper"><span class="">Paraconf_wrapper</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdiplugin-li">
    <a href="/new-site/docs/ref/pdi/plugin/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdiplugin"><span class="">Plugin</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdiplugin_error-li">
    <a href="/new-site/docs/ref/pdi/plugin_error/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdiplugin_error"><span class="">Plugin_error</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id="m-new-sitedocsrefpdipointer_datatype-li">
    <a href="/new-site/docs/ref/pdi/pointer_datatype/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdipointer_datatype"><span class="">Pointer_datatype</span></a>
    
      
      <ul class="pr-md-3 ul-4">
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdipointer_datatypeaccessor-li">
    <a href="/new-site/docs/ref/pdi/pointer_datatype/accessor/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdipointer_datatypeaccessor"><span class="">Accessor</span></a>
    
  </li>

          
        
      </ul>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id="m-new-sitedocsrefpdirecord_datatype-li">
    <a href="/new-site/docs/ref/pdi/record_datatype/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdirecord_datatype"><span class="">Record_datatype</span></a>
    
      
      <ul class="pr-md-3 ul-4">
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdirecord_datatypemember-li">
    <a href="/new-site/docs/ref/pdi/record_datatype/member/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdirecord_datatypemember"><span class="">Member</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdirecord_datatypemember_accessor-li">
    <a href="/new-site/docs/ref/pdi/record_datatype/member_accessor/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdirecord_datatypemember_accessor"><span class="">Member_accessor</span></a>
    
  </li>

          
        
      </ul>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdiref_any-li">
    <a href="/new-site/docs/ref/pdi/ref_any/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdiref_any"><span class="">Ref_any</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id="m-new-sitedocsrefpdireference_base-li">
    <a href="/new-site/docs/ref/pdi/reference_base/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdireference_base"><span class="">Reference_base</span></a>
    
      
      <ul class="pr-md-3 ul-4">
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdireference_basereferenced_buffer-li">
    <a href="/new-site/docs/ref/pdi/reference_base/referenced_buffer/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdireference_basereferenced_buffer"><span class="">Referenced_buffer</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdireference_basereferenced_data-li">
    <a href="/new-site/docs/ref/pdi/reference_base/referenced_data/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdireference_basereferenced_data"><span class="">Referenced_data</span></a>
    
  </li>

          
        
      </ul>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdiright_error-li">
    <a href="/new-site/docs/ref/pdi/right_error/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdiright_error"><span class="">Right_error</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdiscalar_datatype-li">
    <a href="/new-site/docs/ref/pdi/scalar_datatype/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdiscalar_datatype"><span class="">Scalar_datatype</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdistate_error-li">
    <a href="/new-site/docs/ref/pdi/state_error/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdistate_error"><span class="">State_error</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdisystem_error-li">
    <a href="/new-site/docs/ref/pdi/system_error/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdisystem_error"><span class="">System_error</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpditype_error-li">
    <a href="/new-site/docs/ref/pdi/type_error/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpditype_error"><span class="">Type_error</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdiunavailable_error-li">
    <a href="/new-site/docs/ref/pdi/unavailable_error/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdiunavailable_error"><span class="">Unavailable_error</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdivalue_error-li">
    <a href="/new-site/docs/ref/pdi/value_error/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdivalue_error"><span class="">Value_error</span></a>
    
  </li>

          
        
      </ul>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefpdi_errhandler_t-li">
    <a href="/new-site/docs/ref/pdi_errhandler_t/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefpdi_errhandler_t"><span class="">PDI_errhandler_t</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefspdlog-li">
    <a href="/new-site/docs/ref/spdlog/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefspdlog"><span class="">spdlog</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id="m-new-sitedocsrefstd-li">
    <a href="/new-site/docs/ref/std/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefstd"><span class="">std</span></a>
    
      
      <ul class="pr-md-3 ul-3">
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id="m-new-sitedocsrefstdhash__pdi__ref_any__r__w____-li">
    <a href="/new-site/docs/ref/std/hash__pdi__ref_any__r__w____/" title="" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section" id="m-new-sitedocsrefstdhash__pdi__ref_any__r__w____"><span class="">hash&lt; PDI::Ref_any&lt; R, W &gt; &gt;</span></a>
    
  </li>

          
        
      </ul>
    
  </li>

          
        
      </ul>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-new-sitedocschecklists-li">
    <a href="/new-site/docs/checklists/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id="m-new-sitedocschecklists"><span class="">Checklists</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-new-sitedocsconcepts-li">
    <a href="/new-site/docs/concepts/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id="m-new-sitedocsconcepts"><span class="">Core Concepts</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-new-sitedocsfirst_steps-li">
    <a href="/new-site/docs/first_steps/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id="m-new-sitedocsfirst_steps"><span class="">First steps with PDI</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-new-sitedocsfti_plugin-li">
    <a href="/new-site/docs/fti_plugin/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id="m-new-sitedocsfti_plugin"><span class="">FTI plugin</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-new-sitedocshands_on-li">
    <a href="/new-site/docs/hands_on/" class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__page" id="m-new-sitedocshands_on"><span class="td-sidebar-nav-active-item">Hands-on tutorial</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-new-sitedocshow_to_create_plugin-li">
    <a href="/new-site/docs/how_to_create_plugin/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id="m-new-sitedocshow_to_create_plugin"><span class="">How to create a plugin</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-new-sitedocsinstallation-li">
    <a href="/new-site/docs/installation/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id="m-new-sitedocsinstallation"><span class="">Installation of PDI source distribution</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-new-sitedocspdi_example-li">
    <a href="/new-site/docs/pdi_example/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id="m-new-sitedocspdi_example"><span class="">PDI examples</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-new-sitedocspdi_usage-li">
    <a href="/new-site/docs/pdi_usage/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id="m-new-sitedocspdi_usage"><span class="">PDI usage</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-new-sitedocsplugins-li">
    <a href="/new-site/docs/plugins/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id="m-new-sitedocsplugins"><span class="">Plugins</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-new-sitedocspycall_plugin-li">
    <a href="/new-site/docs/pycall_plugin/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id="m-new-sitedocspycall_plugin"><span class="">Pycall plugin</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-new-sitedocsserialize_plugin-li">
    <a href="/new-site/docs/serialize_plugin/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id="m-new-sitedocsserialize_plugin"><span class="">Serialize plugin</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-new-sitedocsset_value_plugin-li">
    <a href="/new-site/docs/set_value_plugin/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id="m-new-sitedocsset_value_plugin"><span class="">Set_value plugin</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-new-sitedocsspecification_tree_ref-li">
    <a href="/new-site/docs/specification_tree_ref/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id="m-new-sitedocsspecification_tree_ref"><span class="">Specification tree Reference</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-new-sitedocsdecl_hdf5_plugin-li">
    <a href="/new-site/docs/decl_hdf5_plugin/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id="m-new-sitedocsdecl_hdf5_plugin"><span class="">The Decl&#39;HDF5 plugin</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-new-sitedocsdecl_netcdf_plugin-li">
    <a href="/new-site/docs/decl_netcdf_plugin/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id="m-new-sitedocsdecl_netcdf_plugin"><span class="">The Decl&#39;NetCDF plugin</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-new-sitedocsflowvr_plugin-li">
    <a href="/new-site/docs/flowvr_plugin/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id="m-new-sitedocsflowvr_plugin"><span class="">The FlowVR plugin</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-new-sitedocsuser_code_plugin-li">
    <a href="/new-site/docs/user_code_plugin/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id="m-new-sitedocsuser_code_plugin"><span class="">The user-code plugin</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-new-sitedocstrace_plugin-li">
    <a href="/new-site/docs/trace_plugin/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id="m-new-sitedocstrace_plugin"><span class="">Trace plugin</span></a>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-new-sitedocsyaml-li">
    <a href="/new-site/docs/yaml/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__page" id="m-new-sitedocsyaml"><span class="">YAML</span></a>
    
  </li>

          
        
      </ul>
    
  </li>

    </ul>
  </nav>
</div>




          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
            
  
  
  
  
  
  <div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
  
  
  </div>





<nav id="TableOfContents">
  <ul>
    <li><a href="#setup">Setup</a>
      <ul>
        <li><a href="#pdi-installation">PDI Installation</a></li>
        <li><a href="#setup-the-hands-on-tutorial">Setup the hands-on tutorial</a></li>
        <li><a href="#compilation">Compilation</a></li>
        <li><a href="#execution">Execution</a></li>
      </ul>
    </li>
    <li><a href="#pdi-free-code">PDI-free code</a>
      <ul>
        <li><a href="#ex1-getting-started">Ex1. Getting started</a></li>
      </ul>
    </li>
    <li><a href="#pdi-core--trace-plugin">PDI core &amp; trace plugin</a>
      <ul>
        <li><a href="#ex2-now-with-some-pdi">Ex2. Now with some PDI</a></li>
      </ul>
    </li>
    <li><a href="#declhdf5-plugin">Decl'HDF5 plugin</a>
      <ul>
        <li><a href="#ex3-hdf5-through-pdi">Ex3. HDF5 through PDI</a></li>
        <li><a href="#ex4-writing-some-real-data">Ex4. Writing some real data</a></li>
        <li><a href="#ex5-introducing-events">Ex5. Introducing events</a></li>
        <li><a href="#ex6-simplifying-the-code">Ex6. Simplifying the code</a></li>
        <li><a href="#ex7-writing-a-selection">Ex7. Writing a selection</a></li>
        <li><a href="#ex8-selecting-on-the-dataset-size">Ex8. Selecting on the dataset size</a></li>
      </ul>
    </li>
    <li><a href="#parallel-declhdf5">parallel Decl'HDF5</a>
      <ul>
        <li><a href="#ex9-going-parallel">Ex9. Going parallel</a></li>
      </ul>
    </li>
    <li><a href="#pycall">Pycall</a>
      <ul>
        <li><a href="#ex10-post-processing-the-data-in-python">Ex10. Post-processing the data in python</a></li>
      </ul>
    </li>
    <li><a href="#what-next-">What next ?</a></li>
  </ul>
</nav>



          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		







<li class="breadcrumb-item" >
	<a href="http://pdi.julien-bigot.fr/new-site/docs/">Documentation</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="http://pdi.julien-bigot.fr/new-site/docs/hands_on/">Hands-on tutorial</a>
</li>

	</ol>
</nav	>

            
<div class="td-content">
	<h1>Hands-on tutorial</h1>
    
	       
	<p>In this tutorial, you will build a PDI-enabled application step-by-step from a PDI-free base. You will end-up building the C version of the <a href="compound:PDI_example">example provided with PDI</a> for the the <a href="compound:trace_plugin">Trace</a>, <a href="compound:Decl_HDF5_plugin">Decl'HDF5</a>, and <a href="compound:pycall_plugin">Pycall</a> plugins. Additional <a href="https://gitlab.maisondelasimulation.fr/pdidev/pdi/-/tree/master/example">examples are available for the other plugins</a>.</p>
<h2 id="setup">Setup</h2>
<h3 id="pdi-installation">PDI Installation</h3>
<p>To run this hands-on tutorial, you will of course first need to <a href="compound:Installation">install PDI</a> and setup your environment.</p>
<p>On Juwels, <a href="compound:namespacePDI">PDI</a> is pre-installed as part of the training2022 environment. To load it, just run:</p>
<pre><code>source /p/project/training2022/setup
</code></pre><h3 id="setup-the-hands-on-tutorial">Setup the hands-on tutorial</h3>
<p>Once PDI is installed, you can proceed with getting the sources for the hands-on tutorial from <a href="https://github.com/pdidev/tutorial">github</a>:</p>
<pre><code>git clone https://github.com/pdidev/tutorial.git
cd tutorial
</code></pre><p>On Juwels, you can just copy the content from <code>${PROJECT_training2022}/PDI_tutorial</code>:</p>
<pre><code>cp -R ${PROJECT_training2022}/PDI_tutorial .
cd PDI_tutorial
</code></pre><h3 id="compilation">Compilation</h3>
<p>Before compilation, configure the tutorial by detecting all dependencies:</p>
<pre><code>cmake .
</code></pre><p>For each exercise, once you've modified it, you can compile it by running the following command:</p>
<pre><code>make ex?
</code></pre><p>Where <code>?</code> is the number of the exercise.</p>
<h3 id="execution">Execution</h3>
<p>In order to speedup the execution on Juwels, it's a good idea to use <code>salloc</code> to reserve one node:</p>
<pre><code>salloc --reservation=parallel-io-day3 -N 1
</code></pre><p>You can run each exercise with the following command:</p>
<pre><code>srun -n 4 ./ex?
</code></pre><p>Where <code>?</code> is the number of the exercise and 4 represents the number of MPI processes to use.</p>
<p>In order to generate clean logs into a file however, the command should be expanded as follow (for example for ex2.):</p>
<pre><code>UCX_LOG_LEVEL=error srun -n 1 -o ex2.juwels.log -e all ./ex2
</code></pre><p>Now you're ready to work, <strong>good luck</strong>!</p>
<h2 id="pdi-free-code">PDI-free code</h2>
<h3 id="ex1-getting-started">Ex1. Getting started</h3>
<p>Ex1. implements a simple heat equation solver using an explicit forward finite difference scheme parallelized with MPI. The code uses a block domain decomposition where each process holds a 2D block of data.</p>
<p><img src="/docs/imgs/heat_global_matrix.jpg" alt="Data domain decomposition in the example"></p>
<p><img src="/docs/imgs/heat_global_matrix.jpg" alt="Data domain decomposition in the example"></p>
<p><img src="/docs/imgs/heat_global_matrix.jpg" alt="Data domain decomposition in the example"></p>
<p><img src="/docs/imgs/heat_global_matrix.jpg" alt="Data domain decomposition in the example"></p>
<p>Locally, each process holds its local block of data with one additional element on each side for ghost zones.</p>
<p><img src="/docs/imgs/heat_local_matrix.jpg" alt="Data domain decomposition in the example"></p>
<p><img src="/docs/imgs/heat_local_matrix.jpg" alt="Data domain decomposition in the example"></p>
<p><img src="/docs/imgs/heat_local_matrix.jpg" alt="Data domain decomposition in the example"></p>
<p><img src="/docs/imgs/heat_local_matrix.jpg" alt="Data domain decomposition in the example"></p>
<p>In the following exercises however, PDI will only be used to decouple I/O operations. There is no need to fully dive in the core of the solver described in the <a href="member:PDI_example_1heat_algorithm">PDI example algorithm</a> and implemented in the <code>iter</code> and <code>exchange</code> functions.</p>
<p>The specification tree in the <code>.yml</code> files and the <code>main</code> function are the locations where all the I/O-related aspects will be handled and the only ones you will actually need to fully understand or modify.</p>
<ul>
<li>Examine the source code, compile it and run it. There is no input/output operations in the code yet, so you can not see any result.</li>
</ul>
<p>This example gets its configuration from a file in the <a href="compound:YAML">YAML format</a>: <code>ex1.yml</code> file. If you're not familiar with YAML, please have a look at our quick <a href="compound:YAML">YAML format documentation</a> to understand it. The example uses the <a href="https://github.com/pdidev/paraconf">paraconf library</a> to read this file.</p>
<ul>
<li>Play with and understand the code parameters in <code>ex1.yml</code>.</li>
<li>Set values in <code>ex1.yml</code> to be able to run the code with 4 MPI processes.</li>
</ul>
<pre><code>srun -n 4 ./ex1
</code></pre><h2 id="pdi-core--trace-plugin">PDI core &amp; trace plugin</h2>
<h3 id="ex2-now-with-some-pdi">Ex2. Now with some PDI</h3>
<p>Ex2. is the same code as that of ex1. with PDI calls added in <code>main</code> function. In our YAML file (<code>ex2.yml</code>), a new sub-tree has been added under the <code>pdi</code> key. This sub-tree is the PDI specification tree passed to PDI at initialization. Here, the PDI <a href="compound:trace_plugin">Trace plugin</a> is used to trace PDI calls.</p>
<ul>
<li>
<p>Examine the source code, compile it and run it.</p>
</li>
<li>
<p>Add the required <code>PDI_share</code> and <code>PDI_reclaim</code> calls to match the output of <code>ex2.log</code> file (only the lines matching <code>[Trace-plugin]</code> have been kept). You only need to change the <code>ex2.c</code> file. You can easily check if the files are the same by running the command:</p>
<pre><code>diff ex2.log &lt;(grep Trace-plugin ex2.juwels.log)
</code></pre></li>
</ul>


<div class="alert alert-primary" role="alert">


    Notice that some share/reclaim pairs come one after the other while others are interlaced. Is one better than the other? If you do not know the answer to this question, just wait until Ex5. :)

</div>

<h2 id="declhdf5-plugin">Decl'HDF5 plugin</h2>
<h3 id="ex3-hdf5-through-pdi">Ex3. HDF5 through PDI</h3>
<p>In this exercise, the code is the same as in ex2. No need to touch the C code here, modification of the YAML file (<code>ex3.yml</code>) should be enough.</p>
<ul>
<li>Examine the YAML file, compile the code and run it.</li>
</ul>
<p>The <a href="compound:trace_plugin">Trace plugin</a> (<code>trace</code>) was replaced by the <a href="compound:Decl_HDF5_plugin">Decl'HDF5 plugin</a> (<code>decl_hdf5</code>) in the specification tree. In its configuration, the <code>dsize</code> variable is written.</p>
<ul>
<li>
<p>Write the <code>psize</code> and <code>pcoord</code> variables in addition to <code>dsize</code> to match the content expected as described in the <code>ex3.h5dump</code> text file (use the <code>h5dump</code> command to see the content of your HDF5 output file in the same format as the <code>.h5dump</code> file). You can easily check if the files are the same by running the command:</p>
<pre><code>diff ex3.h5dump &lt;(h5dump ex3.h5)
</code></pre></li>
</ul>
<p>To achieve this result, you will need to fill 2 sections in the YAML file.</p>
<ol>
<li>The <code>data</code> section to indicate to PDI the <a href="member:Specification_tree_ref_1datatype_node">datatype</a> type of the fields that are exposed.</li>
<li>The <code>decl_hdf5</code> section for the configuration of the <a href="compound:Decl_HDF5_plugin">Decl'HDF5 plugin</a>.</li>
</ol>


<div class="alert alert-primary" role="alert">


    If you relaunch the executable, remember to delete your old <code>ex3.h5</code> file before, otherwise the data will not be changed.

</div>



<div class="alert alert-primary" role="alert">


    Since we write to the same location independently of the MPI rank, this exercise will fail if more than one MPI rank is used.

</div>

<h3 id="ex4-writing-some-real-data">Ex4. Writing some real data</h3>
<p>In this exercise each MPI process will write its local 2D array block contained in the <code>main_field</code> variable to a separate HDF5 file. Once again, this can be done by modifying the YAML file only, no nee to touch the C file.</p>
<ul>
<li>Examine the YAML file, compile the code and run it.</li>
</ul>
<p>Look at the number of blocks, you will have to use the correct number of MPI ranks to run the example.</p>
<p>Notice that in the YAML file, a list was used in the <code>decl_hdf5</code> section with multiple write blocks instead of a single one as before in order to write to multiple files.</p>
<p>Also notice that this example now runs in parallel with two processes. Therefore it uses &quot;$-expressions&quot; to specify the file names and ensure we do not write to the same file from distinct ranks.</p>
<p>Unlike the other fields manipulated until now, the type of <code>main_field</code> is not fully known, its size is dynamic. By moving other fields in the <code>metadata</code> section, you can reference them from &quot;$-expressions&quot; in the configuration file.</p>
<ul>
<li>Use a $-expression to specify the size of <code>main_field</code>.</li>
</ul>
<p>Unlike the other fields manipulated until now, <code>main_field</code> is exposed multiple times along execution. In order not to overwrite it every time it is exposed, you need to add a <code>when</code> condition to restrict its output.</p>
<ul>
<li>Only write <code>main_field</code> at the second iteration (when <code>ii=1</code>) and match the expected content as described in <code>ex4.h5dump</code>.</li>
</ul>
<h3 id="ex5-introducing-events">Ex5. Introducing events</h3>
<p>In ex4., two variables were written to <code>ex4-data*.h5</code>, but the file was opened and closed for each and every write. Since Decl'HDF5 only sees the data appear one after the other, it does not keep the file open. Since <code>ii</code> and <code>main_field</code> are shared in an interlaced way, they are both available to PDI at the same time and could be written without opening the file twice. You have to use events for that, you will modify both the C and YAML file.</p>
<ul>
<li>Examine the YAML file and source code.</li>
<li>In the C file, trigger a PDI event named <code>loop</code> when both <code>ii</code> and <code>main_field</code> are shared. With the <a href="compound:trace_plugin">Trace plugin</a>, check that the event is indeed triggered at the expected time as described in <code>ex5.log</code> (only the lines matching <code>[Trace-plugin]</code> have been kept).</li>
<li>Use the <code>on_event</code> mechanism to trigger the write of <code>ii</code> and <code>main_field</code>. This mechanism can be combined with a <code>when</code> directive, in that case the write is only executed when both mechanisms agree.</li>
<li>Also notice the extended syntax that make it possible to write data to a dataset whose name differs from the PDI variable name. Use this mechanism to write <code>main_field</code> at iterations 1 and 2, in two distinct groups <code>iter1</code> and <code>iter2</code>. Your output should match the content described in <code>ex5.h5dump</code>.</li>
</ul>
<h3 id="ex6-simplifying-the-code">Ex6. Simplifying the code</h3>
<p>As you can notice, the PDI code is quite redundant. In this exercise, you will use <code>PDI_expose</code> and <code>PDI_multi_expose</code> to simplify the code while keeping the exact same behaviour. For once, there is no need to modify the YAML file here, you only need to modify the C file in this exercise.</p>
<ul>
<li>Examine the source code, compile it and run it.</li>
</ul>
<p>There are lots of matched <code>PDI_share</code>/<code>PDI_reclaim</code> in the code.</p>
<ul>
<li>Replace these by <code>PDI_expose</code> that is the exact equivalent of a <code>PDI_share</code> followed by a matching <code>PDI_reclaim</code>.</li>
</ul>
<p>This replacement is not possible for interlaced <code>PDI_share</code>/<code>PDI_reclaim</code> with events in the middle. This case is however handled by <code>PDI_multi_expose</code> call that exposes all data, then triggers an event and finally does all the reclaim in reverse order.</p>
<ul>
<li>
<p>Replace the remaining <code>PDI_share</code>/<code>PDI_reclaim</code> by <code>PDI_expose</code>s and <code>PDI_multi_expose</code>s and ensure that your code keeps the exact same behaviour by comparing its trace to <code>ex6.log</code> (only the lines matching <code>[Trace-plugin]</code> have been kept). You can easily check if the files are the same by running:</p>
<pre><code>diff ex6.log &lt;(grep Trace-plugin ex6.juwels.log)
</code></pre></li>
</ul>
<h3 id="ex7-writing-a-selection">Ex7. Writing a selection</h3>
<p>In this exercise, you will only write a selection of the 2D array in memory excluding ghosts to the HDF5 file. Once again, you only need to modify the YAML file in this exercise, no need to touch the C file.</p>
<ul>
<li>Examine the YAML file and compile the code.</li>
</ul>
<p>As you can notice, now the dataset is independently described in the file.</p>
<ul>
<li>
<p>Restrict the selection to the non-ghost part of the array in memory (excluding one element on each side). You should be able to match the expected output described in <code>ex7.h5dump</code>. You can easily check if the files are the same by running:</p>
<pre><code>diff ex7.h5dump &lt;(h5dump ex7-data0x0.h5)
</code></pre></li>
</ul>
<p>You can achieve this by using the <code>memory_selection</code> directive that specifies the selection of data from memory to write.</p>
<p><img src="/docs/imgs/PDI_hdf5_selection.jpg" alt="graphical representation"></p>
<p><img src="/docs/imgs/PDI_hdf5_selection.jpg" alt="graphical representation"></p>
<p><img src="/docs/imgs/PDI_hdf5_selection.jpg" alt="graphical representation"></p>
<p><img src="/docs/imgs/PDI_hdf5_selection.jpg" alt="graphical representation"></p>
<h3 id="ex8-selecting-on-the-dataset-size">Ex8. Selecting on the dataset size</h3>
<p>In this exercise, you will once again change the YAML file to handle a selection in the dataset in addition to the selection in memory from the previous exercise. You will write the 2D array from the previous exercise as a slice of 3D dataset including a dimension for time. Once again, you only need to modify the YAML file in this exercise, no need to touch the C file.</p>
<ul>
<li>Examine the YAML file and compile the code.</li>
</ul>
<p>Notice how the dataset is now extended with an additional dimension for three time-steps.</p>
<ul>
<li>
<p>Write the 2D selection from <code>main_field</code> at iterations 1 to 3 inclusive into slices at coordinate 0 to 2 of first dimension of the 3D dataset. Match the expected output described in <code>ex8.h5dump</code>. You can easily check if the files are the same by running:</p>
<pre><code>diff ex8.h5dump &lt;(h5dump ex8-data0x0.h5)
</code></pre></li>
</ul>
<p>You can achieve this by using the <code>dataset_selection</code> directive that specifies the selection where to write in the file dataset.</p>
<p><img src="/docs/imgs/PDI_hdf5_selection_advanced.jpg" alt="graphical representation"></p>
<p><img src="/docs/imgs/PDI_hdf5_selection_advanced.jpg" alt="graphical representation"></p>
<p><img src="/docs/imgs/PDI_hdf5_selection_advanced.jpg" alt="graphical representation"></p>
<p><img src="/docs/imgs/PDI_hdf5_selection_advanced.jpg" alt="graphical representation"></p>
<h2 id="parallel-declhdf5">parallel Decl'HDF5</h2>
<h3 id="ex9-going-parallel">Ex9. Going parallel</h3>
<p>Running the code from the previous exercises in parallel should already work and yield one file per process containing the local data block. In this exercise you will write one single file with parallel HDF5 whose content should be independent from the number of processes used. Once again, you only need to modify the YAML file in this exercise, no need to touch the C file.</p>
<ul>
<li>Examine the YAML file and compile the code.</li>
</ul>
<p>The <code>mpi</code> plugin was loaded to make sharing MPI communicators possible.</p>
<ul>
<li>Uncomment the <code>communicator</code> directive of the <a href="compound:Decl_HDF5_plugin">Decl'HDF5 plugin</a> to switch to parallel I/O and change the file name so that all processes access the same file.</li>
<li>Set the size of the dataset to take the global (parallel) array size into account. You will need to multiply the local size by the number of processes in each dimension (use <code>psize</code>).</li>
<li>Ensure the dataset selection of each process does not overlap with the others. You will need to make a selection in the dataset that depends on the global coordinate of the local data block (use <code>pcoord</code>).</li>
</ul>
<p>Match the output from <code>ex9.h5dump</code>, that should be independent from the number of processes used. You can easily check if the files are the same by running:</p>
<pre><code>diff ex9.h5dump &lt;(h5dump ex9.h5)
</code></pre><p><img src="/docs/imgs/PDI_hdf5_parallel.jpg" alt="graphical representation of the parallel I\/O"></p>
<p><img src="/docs/imgs/PDI_hdf5_parallel.jpg" alt="graphical representation of the parallel I\/O"></p>
<p><img src="/docs/imgs/PDI_hdf5_parallel.jpg" alt="graphical representation of the parallel I\/O"></p>
<p><img src="/docs/imgs/PDI_hdf5_parallel.jpg" alt="graphical representation of the parallel I\/O"></p>
<h2 id="pycall">Pycall</h2>
<h3 id="ex10-post-processing-the-data-in-python">Ex10. Post-processing the data in python</h3>
<p>In this exercise, you will once again modify the YAML file only and use python to post-process the data in situ before writing it to HDF5. Here, you will write the square root of the raw data to HDF5 instead of the data itself.</p>
<ul>
<li>Examine the YAML file and compile the code.</li>
</ul>
<p>Notice that the Decl'HDF5 configuration was simplified, no memory selection is applied, the when condition disappeared. The dataset name is however explicitly specified now because it does not match the PDI variable name anymore, you will instead write a new variable exposed from python.</p>
<p>The <code>pycall</code> section has been added to load the <a href="compound:pycall_plugin">Pycall plugin</a>. It executes the provided code when the &quot;loop&quot; event is triggered. The <code>with</code> section specifies the variables (parameters) to pass to Python as a set of &quot;$-expressions&quot;. The provided code again exposes its result to PDI and multiple blocks can be chained this way.</p>
<ul>
<li>
<p>Add the missing parameter to the <code>with</code> block to let the Python code process the data exposed in <code>main_field</code>.</p>
</li>
<li>
<p>Modify the Decl'HDF5 configuration to write the new data exposed from Python.</p>
</li>
<li>
<p>Match the output from <code>ex10.h5dump</code>. You can easily check if the files are the same by running:</p>
<pre><code>diff ex10.h5dump &lt;(h5dump ex10.h5)
</code></pre></li>
</ul>


<div class="alert alert-primary" role="alert">


    In a more realistic setup, one would typically not write much code in the YAML file directly, but would instead call functions specified in a <code>.py</code> file on the side.

</div>

<h2 id="what-next-">What next ?</h2>
<p>In this tutorial, you used the C API of PDI and from YAML, you used the <a href="compound:trace_plugin">Trace</a>, <a href="compound:Decl_HDF5_plugin">Decl'HDF5</a>, and <a href="compound:pycall_plugin">Pycall</a> plugins.</p>
<p>If you want to try <a href="compound:namespacePDI">PDI</a> from another language (Fortran, python, ...) or if you want to experiment with other <a href="compound:Plugins">PDI plugins</a>, have a look at the <a href="https://gitlab.maisondelasimulation.fr/pdidev/pdi/-/tree/master/example">examples provided with PDI</a>.</p>

	
	
	<div class="text-muted mt-5 pt-3 border-top">Last modified January 1, 0001
</div>
</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack for users" aria-label="Slack for users">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://join.slack.com/t/pdidev/shared_invite/enQtNDk5OTY2MDA0Nzg0LTlkM2U1MGQwZmM3OGM1MjA0M2VlMzUyNWNjODhkNmI4MjMwZmQxMTM1ODc2ODI4MjY4ODNmNDhmY2QzOWI4Nzk">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Gitlab for users" aria-label="Gitlab for users">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://gitlab.maisondelasimulation.fr/pdidev/pdi/-/tags">
      <i class="fab fa-gitlab"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitLab" aria-label="GitLab">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://gitlab.maisondelasimulation.fr/pdidev/">
      <i class="fab fa-gitlab"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://join.slack.com/t/pdidev/shared_invite/enQtNDk5OTY2MDA0Nzg0LTlkM2U1MGQwZmM3OGM1MjA0M2VlMzUyNWNjODhkNmI4MjMwZmQxMTM1ODc2ODI4MjY4ODNmNDhmY2QzOWI4Nzk">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Jenkins" aria-label="Jenkins">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://ci.inria.fr/ah5/">
      <i class="fab fa-jenkins"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://github.com/pdidev">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="DockerHub" aria-label="DockerHub">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://hub.docker.com/orgs/pdidev">
      <i class="fab fa-docker"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2021 The PDI team All Rights Reserved</small>
        
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF" crossorigin="anonymous"></script>






 













<script src="/new-site/js/main.min.3b172c13b62c2bea8b1c9d2599cddc8cf89718a92d792c680871c81ba43d8c85.js" integrity="sha256-OxcsE7YsK&#43;qLHJ0lmc3cjPiXGKkteSxoCHHIG6Q9jIU=" crossorigin="anonymous"></script>






  </body>
</html>